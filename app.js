!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},i={},s={},a={}.hasOwnProperty,r=/^\.\.?(\/|$)/,n=function(e,t){for(var i,s=[],a=(r.test(t)?e+"/"+t:t).split("/"),n=0,o=a.length;n<o;n++)i=a[n],".."===i?s.pop():"."!==i&&""!==i&&s.push(i);return s.join("/")},o=function(e){return e.split("/").slice(0,-1).join("/")},l=function(t){return function(i){var s=n(o(t),i);return e.require(s,t)}},c=function(e,t){var s=f&&f.createHot(e),a={id:e,exports:{},hot:s};return i[e]=a,t(a.exports,l(e),a),a.exports},h=function(e){return s[e]?h(s[e]):e},d=function(e,t){return h(n(o(e),t))},u=function(e,s){null==s&&(s="/");var r=h(e);if(a.call(i,r))return i[r].exports;if(a.call(t,r))return c(r,t[r]);throw new Error("Cannot find module '"+e+"' from '"+s+"'")};u.alias=function(e,t){s[t]=e};var p=/\.[^.\/]+$/,m=/\/index(\.[^\/]+)?$/,y=function(e){if(p.test(e)){var t=e.replace(p,"");a.call(s,t)&&s[t].replace(p,"")!==t+"/index"||(s[t]=e)}if(m.test(e)){var i=e.replace(m,"");a.call(s,i)||(s[i]=e)}};u.register=u.define=function(e,s){if(e&&"object"==typeof e)for(var r in e)a.call(e,r)&&u.register(r,e[r]);else t[e]=s,delete i[e],y(e)},u.list=function(){var e=[];for(var i in t)a.call(t,i)&&e.push(i);return e};var f=e._hmr&&new e._hmr(d,u,t,i);u._cache=i,u.hmr=f&&f.wrap,u.brunch=!0,e.require=u}}(),function(){"undefined"==typeof window?this:window;require.register("initialize.js",function(e,t,i){window.game=new Phaser.Game({width:800,height:600,type:Phaser.AUTO,title:"ðŸ’Ž Kristal Quest",url:"https://github.com/samme/kristal-quest",version:"0.0.1",banner:{background:["#eb4149","#ebba16","#42af5c","#2682b1","#28434d"]},clearBeforeRender:!1,loader:{path:"assets/",maxParallelDownloads:6},physics:{"default":"arcade",arcade:{debug:!0,gravity:{y:600},height:775,width:1600,x:0,y:-200}},scene:[t("scenes/boot"),t("scenes/default"),t("scenes/menu")]})}),require.register("scenes/boot.js",function(e,t,i){var s=2236962,a=16720384,r=16777215;i.exports={key:"boot",preload:function(){this.load.bitmapFont("smooth","atari-smooth.png","atari-smooth.xml"),this.load.bitmapFont("sunset","atari-sunset.png","atari-sunset.xml"),this.load.image("diamond"),this.load.image("mtn"),this.load.image("pineapple"),this.load.image("platform"),this.load.image("ship"),this.load.image("slime"),this.load.image("slimeeyes"),this.load.image("space1"),this.load.image("space2"),this.load.image("star"),this.load.image("yellow"),this.load.spritesheet("dude","dude.png",{frameWidth:32,frameHeight:48}),this.load.on("progress",this.onLoadProgress,this),this.load.on("complete",this.onLoadComplete,this),this.createProgressBar()},create:function(){this.createAnims(),this.scene.start("menu")},extend:{progressBar:null,progressBarRectangle:null,createAnims:function(){this.anims.create({key:"left",frames:this.anims.generateFrameNumbers("dude",{start:0,end:3}),frameRate:10,repeat:-1}),this.anims.create({key:"turn",frames:[{key:"dude",frame:4}],frameRate:20}),this.anims.create({key:"right",frames:this.anims.generateFrameNumbers("dude",{start:5,end:8}),frameRate:10,repeat:-1})},createProgressBar:function(){var e=this.cameras.main;this.progressBarRectangle=new Phaser.Geom.Rectangle(0,0,.5*e.width,50),Phaser.Geom.Rectangle.CenterOn(this.progressBarRectangle,.5*e.width,.5*e.height),this.progressBar=this.add.graphics()},onLoadComplete:function(e){console.log("onLoadComplete",e),this.progressBar.destroy()},onLoadProgress:function(e){var t=this.progressBarRectangle,i=this.load.failed.size>0?a:r;this.progressBar.clear().fillStyle(s).fillRect(t.x,t.y,t.width,t.height).fillStyle(i).fillRect(t.x,t.y,e*t.width,t.height),console.log("progress",e)}}}}),require.register("scenes/default.js",function(e,t,i){var s,a,r,n,o,l,c,h,d,u,p,m,y,f,g,b,w=65314,x=1e3,v=16777215,P=16768256;i.exports={key:"default",init:function(){d=!1,u=!1,p=0,g=null,this.time.update(0,0),g=this.time.now},create:function(){this.add.image(400,300,"space1").setScrollFactor(0,0),this.add.tileSprite(400,520,1620,176,"mtn").setScrollFactor(.5),this.add.image(800,-200,"ship").setScrollFactor(1,.25),this.createPlatforms(),this.createPineapple(),this.createPlayer(),this.createSlimes(),this.createGems(),this.createText(),this.createGlow(),this.createParticles(),this.cameras.main.setBounds(0,-1200,1600,1800),this.cameras.main.startFollow(h),this.physics.add.collider([n,l,h,y],c),this.physics.add.overlap(h,n,this.collectGem,this.isPlayerActive,this),this.physics.add.overlap(h,l,this.collectPineapple,this.isPlayerActive,this),this.physics.add.overlap(h,y,this.slimePlayer,this.isPlayerActive,this),s=this.input.keyboard.createCursorKeys(),this.physics.world.drawDebug&&this.input.keyboard.on("keydown_D",this.toggleDebugGraphic,this),this.input.keyboard.once("keydown_G",this.startPlayerGlow,this),this.input.keyboard.once("keydown_Q",this.quit,this),this.input.keyboard.once("keydown_W",this.win,this),this.input.keyboard.once("keydown_L",this.lose,this);var e=this.physics.world.debugGraphic;e&&e.setVisible(!1)},update:function(){this.updatePlayer(),this.updateGlow(),y.children.iterate(this.updateSlime,this),this.updateText()},extend:{checkGems:function(){0===n.countActive(!0)&&this.win()},collectGem:function(e,t){t.disableBody(!0,!0),f.explode(10),p+=1,this.updateText(),this.checkGems()},collectPineapple:function(e,t){t.disableBody(!0,!0),this.startPlayerGlow()},createGem:function(e){e.body.allowGravity=!1,e.body.setSize(28,28),e.setBounce(1,1).setCollideWorldBounds(!0).setVelocity(120*this.randomSign(),120*this.randomSign())},createGems:function(){n=this.physics.add.group({key:"diamond",repeat:11,setXY:{x:50,y:0,stepX:200}}),n.children.iterate(this.createGem,this)},createGlow:function(){o=this.add.image(h.x,h.y,"yellow").setAlpha(.4).setBlendMode("ADD").setVisible(!1),this.tweens.add({alpha:.6,duration:2e3,ease:"Sine.easeInOut",loop:-1,targets:o,yoyo:!0})},createParticles:function(){f=this.add.particles("star").createEmitter({accelerationY:-600,alpha:{start:1,end:0},blendMode:"ADD",lifespan:{min:500,max:1500},on:!1,speed:60}),f.startFollow(h)},createPineapple:function(){l=this.physics.add.image(400,300,"pineapple").setCollideWorldBounds(!0)},createPlatforms:function(){c=this.physics.add.staticGroup();var e=Phaser.Math.Between;c.createMultiple([{key:"platform",repeat:2,setXY:{x:e(0,400),y:150,stepX:e(600,800)}},{key:"platform",repeat:2,setXY:{x:e(-100,300),y:300,stepX:e(600,1e3)}},{key:"platform",repeat:2,setXY:{x:e(-200,200),y:450,stepX:e(600,1200)}}]),c.children.iterateLocal("setTint",250)},createPlayer:function(){h=this.physics.add.sprite(800,600,"dude"),h.setBounce(.2).setCollideWorldBounds(!0).setDragX(600).setName("player"),h.body.maxVelocity.x=300,h.body.setSize(16,48)},createSlimes:function(){y=this.physics.add.group({key:"slime",repeat:3,setXY:{x:100,y:0,stepX:200}}),a=this.add.group({classType:Phaser.GameObjects.Image,key:"slimeeyes",repeat:y.getLength()-1}),a.children.iterateLocal("setActive",!1),y.children.iterate(this.createSlime,this)},createText:function(){b=this.add.bitmapText(10,10,"smooth","").setFontSize(32).setScrollFactor(0,0),m=this.add.bitmapText(110,10,"sunset","").setFontSize(32).setScrollFactor(0,0),r=this.add.bitmapText(400,300,"sunset","").setScrollFactor(0,0).setVisible(!1),this.updateText(),this.add.bitmapText(510,10,"smooth","[Q] QUIT").setAlpha(.5).setFontSize(32).setScrollFactor(0,0)},fadeOutGlow:function(){this.tweens.add({duration:1*x,ease:"Back.easeOut",scaleX:0,scaleY:0,targets:o})},isOnFloor:function(e){return e.body.blocked.down||e.body.touching.down},isPlayerActive:function(){return h.active},createSlime:function(e,t){e.setAlpha(.75).setBounce(1,.2).setCollideWorldBounds(!0).setDataEnabled().setData("eyes",a.getFirst(!1).setActive(!0)).setData("i",t).setMaxVelocity(60,600).setName("slime"+t).setVelocity(60*this.randomSign(),0),e.body.checkCollision.up=!1,e.body.setSize(24,24),this.slimeStopClimb(e)},quit:function(){this.scene.start("menu")},randomSign:function(){return Math.random()>.5?1:-1},secondsElapsed:function(){return console.assert(this.time.now<1e9,"`time.now` is too large"),Math.floor((this.time.now-g)/x)},shutdown:function(){console.log("shutdown")},slimePlayer:function(e,t){d||(u=!0,h.anims.play("turn"),h.body.allowDrag=!0,h.setActive(!1).setDrag(1200,0).setTint(w),t.setAccelerationX(0).setDrag(1200,0).setGravityY(0),this.lose())},slimeStartClimb:function(e){this.isOnFloor(e)&&e.setAccelerationX(0).setDragX(20).setGravityY(-720),this.time.delayedCall(Phaser.Math.Between(1,2)*x,this.slimeStopClimb,[e],this)},slimeStopClimb:function(e){e.setAccelerationX(15).setDragX(0).setGravityY(0),this.time.delayedCall(Phaser.Math.Between(3,17)*x,this.slimeStartClimb,[e],this)},startPlayerGlow:function(){d=!0,o.setPosition(h.x,h.y).setScale(1).setVisible(!0),h.setTint(P),this.time.delayedCall(14*x,this.fadeOutGlow,null,this),this.time.delayedCall(15*x,this.stopPlayerGlow,null,this)},stopPlayerGlow:function(){d=!1,o.setVisible(!1),h.setTint(v)},toggleDebugGraphic:function(){var e=this.physics.world.debugGraphic;e&&e.setVisible(!e.visible)},toggleMap:function(){},win:function(){h.anims.play("turn"),h.body.checkCollision.none=!0,h.setAccelerationX(Phaser.Math.Clamp(800-h.x,-600,600)).setAccelerationY(-1200).setCollideWorldBounds(!1).setDrag(600,0),f.setFrequency(0,1).start();var e=this.secondsElapsed();this.registry.set("lastTime",e),this.gameOver("HOORAY")},lose:function(){this.gameOver("GAME OVER")},gameOver:function(e){r.setText(e).setOrigin(.5).setVisible(!0),this.input.once("pointerup",this.quit,this)},updateGlow:function(){o.visible&&h.active&&(o.x=Phaser.Math.Linear(o.x,h.x,.75),o.y=Phaser.Math.Linear(o.y,h.y,.75))},updatePlayer:function(){if(!u){var e=this.isOnFloor(h);h.body.allowDrag=e&&h.body.speed>0,e&&(s.left.isDown?(h.body.velocity.x-=30,h.anims.play("left",!0)):s.right.isDown&&(h.body.velocity.x+=30,h.anims.play("right",!0)),s.up.isDown&&h.setVelocityY(-480)),h.body.speed<10&&h.anims.play("turn")}},updateText:function(){m.setText("*".repeat(p)),b.setText(String(this.secondsElapsed()))},updateSlime:function(e){var t=e.getData("eyes");t.setPosition(Phaser.Math.Linear(e.x,t.x,.25),Phaser.Math.Linear(e.y,t.y,.25));var i=e.body.velocity;e.scaleX=Phaser.Math.Linear(e.scaleX,1/(.75+Math.abs(i.y/600)),.5),this.isOnFloor(e)&&(d?e.setAccelerationX(15*Phaser.Math.Clamp(e.x-h.x,-1,1)):Phaser.Math.Within(i.x,0,60)&&e.setAccelerationX(15*Phaser.Math.Clamp(i.x,-1,1)))}}}}),require.register("scenes/menu.js",function(e,t,i){i.exports={key:"menu",create:function(){this.add.image(400,300,"space2"),this.add.bitmapText(400,200,"sunset","KRISTAL\n QUEST").setOrigin(.5),this.add.bitmapText(400,400,"smooth","START").setOrigin(.25,.25).setFontSize(32);var e=this.scene.manager.getScene("default").registry.get("lastTime");e&&this.add.bitmapText(400,500,"sunset","Last Time: "+e).setOrigin(.125,.125).setFontSize(16),this.input.once("pointerup",this.start,this),this.input.keyboard.once("keydown_space",this.start,this)},extend:{start:function(){this.scene.start("default")}}}}),require.register("___globals___",function(e,t,i){})}(),require("___globals___"),require("initialize");